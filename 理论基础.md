## 模组加载机制
在开始制作模组之前，我们先来了解下 KSP 的模组加载机制吧。

当我们启动 KSP 开始读条，KSP会开始加载部件等资源。KSP 会在 `GameData/` 文件夹下寻找所有 `.dll`（托管的）和 `.cfg` 文件并尝试加载它们。

点击调试工具栏的 `数据库` 页面中的 `重新加载数据库` 按钮时也会重新加载除了 `.dll` 以外的 `.cfg` 等文件。

当 KSP 加载一个 `.cfg` 文件时，它会尝试寻找并加载文件中的 `PART` 节点。`PART` 节点中记录了一个部件的各种信息，包括名称、资源文件位置、游戏逻辑等。当它被成功加载时，一个部件就会出现在 KSP 中。

除了 `PART` 节点外，KSP 还会加载 `MODULE` 节点，每一个 `MODULE` 节点都有一个 `name` 属性。加载 `MODULE` 节点时 KSP 会尝试在已加载的 `.dll` 文件中寻找这个 `name` 属性对应名称的 C# 类。每一个部件中每一个 `MODULE` 节点都对应一个 C# 实例，之后 KSP 就会在部件发生特定事件时执行对应类中对应的方法。

一个模组主要分为两个部分：部件和游戏逻辑。我们从前文可以看出，添加或者修改部件可以通过编写 `.cfg` 文件和对应的资源文件来实现，添加或修改游戏逻辑可以通过编写 C# 程序来实现。

> **VB.NET 能写模组吗？（无关紧要）**
>
> 由于 C# 和 VB.NET 编译出的 IL 应该没有太大区别，因此我们猜测理论上可以使用 VB.NET 来编写模组，但还是不建议尝试。
